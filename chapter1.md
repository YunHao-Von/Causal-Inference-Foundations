# Chapter1 
## 因果关系推断的基本概念
### 1.1因果关系推断

##### 因果关系的核心任务：
主要包括因果关系学习与因果效应评估。

##### definition：
因果关系是识别事件或变量之间的因果关系。如果一种现象引起另一种现象的变化，那么一种现象被称为原因，另一种现象被称为结果。

##### 遇到的问题与挑战
因此，因果关系定义的不统一与模糊性给因果关系识别带来了巨大挑战。在计算机给定原因变量对结果变量的因果效应时，混杂因子给因果效应计算带来的混杂偏差问题，也是因果推断领域的核心研究问题之一。

### 1.2 混杂与辛普森悖论

##### 什么是混杂因子：
在研究不同年龄段的研究对象的锻炼量与胆固醇水平之间的关系时。遇到两种情况：
1.如果将研究对象按照年龄段分组，就会得到锻炼得越多，胆固醇水平就越低。
2.如果不将研究对象进行分组，直接进行研究就会得到相反的结论：即锻炼时间越长，胆固醇水平越高。
这就是辛普森悖论，年龄也被认为是产生辛普森悖论的混杂因子。
##### 定义：
当一个变量同时影响到原因变量和结果变量时，这个变量被称为混杂因子。

<u>在因果推断领域，混杂因子的识别时处理混杂偏差的关键。</u>

##### 混杂问题如何解决：
混杂问题（即混杂因子识别和混杂偏差修正）一直是因果关系推断领域的核心研究问题之一。为解决这个问题，通常从两个角度提出了相应的因果关系推断模型与方法。
1.试验性研究方法
2.数据驱动的研究方法

### 1.3 随机对照实验
随机对照实验时因果关系推断的试验性研究方法，被公认为因果关系推断的黄金法则。

##### 目的与how：
随机对照实验的主要目的是采用人工干预的方式消除混杂因子对因果效应评估的影响，是真正的人为实施的控制与干预操作，观测由此引起的事物或现象的变化来推断变量之间的因果关系。

<u>通过这种方式使得混杂因子失效。</u>

##### 主流方向：
在不需要人为干预的情况下，直接从观测数据中进行因果关系推断已经成为因果推断领域的主流研究方向。

### 1.4 数据驱动的因果推断模型
为了能够利用观测数据进行因果关系推断，开发了数据驱动的因果推断模型。最为著名的是：

**1.潜在结果模型（Potential Outcome Framework）**
<u>侧重社科、计量经济学、流行病学。</u>
研究的核心问题：混杂变量的控制

**2.结构因果模型（Structure Casual Model）**
<u>侧重人工智能与计算机领域。</u>
结构因果模型是贝叶斯网络模型的延申和扩展。
结构因果模型通过<u>因果图</u>与<u>赋值方程</u>表示因果关系。
·因果图：是因果关系的图形化定性表示。
·赋值方程：是因果关系的定量表示。

其中，本书重点：**Pearl结合结构因果模型与do演算发展了一套完整的理论与方法来识别混杂因子和修正混杂偏差**

### 1.5 图模型
与图相关的，单独总结为一个chapter

### 1.6 贝叶斯网络
##### 马尔可夫假设：
对任意的节点Vi，在给定父节点的条件下，Vi和它的非子孙节点条件独立。
##### 贝叶斯网络：
贝叶斯网络由有向无环图G和一个联合概率分布P(v)构成。如果三元组<V,G\P(V)>满足马尔可夫假设，则称三元组为贝叶斯网络。
根据马尔可夫假设，贝叶斯网络所蕴含的条件独立性关系可将联合概率分布$P(\mathcal{V})$分解为：
$$P(\mathcal{V})=\prod_{i=1}^{N}P(V_{i}\mid\operatorname{Pa}(V_{i}))$$
其中，每个局部概率因子表示一个变量在网络中给定父节点时的条件概率。

**高维情况**:对于定义在N个二元随机变量上的联合概率分布$P(V)=P(V_{1},V_{2},\cdots,V_{N})$，确定这个分布需要$2^{N}-1$个独立参数，因此直接计算概率分布$P(V)$是很困难的。一般使用概率的链式法则将$P(V)$进行如下分解：$$P\big(V_{1},\cdots,V_{N}\big)=P\big(V_{1}\big)\prod_{i=2}^{N}P\big(V_{i}\big|V_{1},\cdots,V_{i-1}\big)$$
当N较大时，使用链式法则进行联合概率分布P(V)分解，上式仍然很难计算，根据上上式，假设每个节点在图G中最多有k个父节点，那么所需要的独立参数的个数将少于$N*2^{k}$。在很多实际应用中，k往往远远小于N，使得贝叶斯网络中的参数个数指数级小于联合概率分布参数的个数。

**忠实性假设**:这个假设可以使我们从数据集中学习产生这个数据集的图模型成为可能。d-分离蕴含着图模型背后的数据生成机制，即数据中蕴含的条件独立性关系。
因此，忠实性假设不及是我们可以从一个图模型出发生成一个数据D，也可以从一个数据D出发反推出因果图模型，这也是数据驱动的因果结构学习方法奏效的关键假设。

**条件消元法**:变量消元法利用贝叶斯网络的联合概率分布的模块化性质将联合概率分布分解为每个节点给定其父节点的条件概率的乘积，然后通过改变求和与乘积运算的次序对联合概率分布的变量进行边缘化，实现联合概率分布中的变量消除。


